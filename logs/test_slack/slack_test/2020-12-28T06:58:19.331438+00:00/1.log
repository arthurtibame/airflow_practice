[2020-12-28 14:58:21,104] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: test_slack.slack_test 2020-12-28T06:58:19.331438+00:00 [queued]>
[2020-12-28 14:58:21,117] {taskinstance.py:826} INFO - Dependencies all met for <TaskInstance: test_slack.slack_test 2020-12-28T06:58:19.331438+00:00 [queued]>
[2020-12-28 14:58:21,117] {taskinstance.py:1017} INFO - 
--------------------------------------------------------------------------------
[2020-12-28 14:58:21,117] {taskinstance.py:1018} INFO - Starting attempt 1 of 1
[2020-12-28 14:58:21,117] {taskinstance.py:1019} INFO - 
--------------------------------------------------------------------------------
[2020-12-28 14:58:21,123] {taskinstance.py:1038} INFO - Executing <Task(SlackWebhookOperator): slack_test> on 2020-12-28T06:58:19.331438+00:00
[2020-12-28 14:58:21,125] {standard_task_runner.py:51} INFO - Started process 3172 to run task
[2020-12-28 14:58:21,127] {standard_task_runner.py:75} INFO - Running: ['airflow', 'tasks', 'run', 'test_slack', 'slack_test', '2020-12-28T06:58:19.331438+00:00', '--job-id', '34', '--pool', 'default_pool', '--raw', '--subdir', 'DAGS_FOLDER/slag_practice.py', '--cfg-path', '/tmp/tmpp94kykfv']
[2020-12-28 14:58:21,128] {standard_task_runner.py:76} INFO - Job 34: Subtask slack_test
[2020-12-28 14:58:21,162] {logging_mixin.py:103} INFO - Running <TaskInstance: test_slack.slack_test 2020-12-28T06:58:19.331438+00:00 [running]> on host dataiku
[2020-12-28 14:58:21,200] {taskinstance.py:1232} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=arthur.sl.lin
AIRFLOW_CTX_DAG_ID=test_slack
AIRFLOW_CTX_TASK_ID=slack_test
AIRFLOW_CTX_EXECUTION_DATE=2020-12-28T06:58:19.331438+00:00
AIRFLOW_CTX_DAG_RUN_ID=manual__2020-12-28T06:58:19.331438+00:00
[2020-12-28 14:58:21,249] {base.py:74} INFO - Using connection to: id: slack. Host: https://hooks.slack.com/services/, Port: None, Schema: , Login: , Password: None, extra: None
[2020-12-28 14:58:21,250] {http.py:140} INFO - Sending 'POST' to url: https://hooks.slack.com/services/aaT01D1RB1EMQ/B01HP4PJEUB/yQmkY9NupI7cbG877f5zxVn7
[2020-12-28 14:58:21,768] {http.py:154} ERROR - HTTP error: Not Found
[2020-12-28 14:58:21,768] {http.py:155} ERROR - no_team
[2020-12-28 14:58:21,775] {taskinstance.py:1396} ERROR - 404:Not Found
Traceback (most recent call last):
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 152, in check_response
    response.raise_for_status()
  File "/home/ub/airflow/env/lib/python3.6/site-packages/requests/models.py", line 941, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://hooks.slack.com/services/aaT01D1RB1EMQ/B01HP4PJEUB/yQmkY9NupI7cbG877f5zxVn7

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1086, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1260, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1300, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/slack/operators/slack_webhook.py", line 120, in execute
    self.hook.execute()
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/slack/hooks/slack_webhook.py", line 166, in execute
    extra_options={'proxies': proxies, 'check_response': True},
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 141, in run
    return self.run_and_check(session, prepped_request, extra_options)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 191, in run_and_check
    self.check_response(response)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 156, in check_response
    raise AirflowException(str(response.status_code) + ":" + response.reason)
airflow.exceptions.AirflowException: 404:Not Found
[2020-12-28 14:58:21,776] {taskinstance.py:1440} INFO - Marking task as FAILED. dag_id=test_slack, task_id=slack_test, execution_date=20201228T065819, start_date=20201228T065821, end_date=20201228T065821
[2020-12-28 14:58:21,787] {taskinstance.py:1454} ERROR - Failed at executing callback
[2020-12-28 14:58:21,787] {taskinstance.py:1455} ERROR - Task id 'slack_test' has already been added to the DAG
Traceback (most recent call last):
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 152, in check_response
    response.raise_for_status()
  File "/home/ub/airflow/env/lib/python3.6/site-packages/requests/models.py", line 941, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 404 Client Error: Not Found for url: https://hooks.slack.com/services/aaT01D1RB1EMQ/B01HP4PJEUB/yQmkY9NupI7cbG877f5zxVn7

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1086, in _run_raw_task
    self._prepare_and_execute_task_with_callbacks(context, task)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1260, in _prepare_and_execute_task_with_callbacks
    result = self._execute_task(context, task_copy)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1300, in _execute_task
    result = task_copy.execute(context=context)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/slack/operators/slack_webhook.py", line 120, in execute
    self.hook.execute()
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/slack/hooks/slack_webhook.py", line 166, in execute
    extra_options={'proxies': proxies, 'check_response': True},
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 141, in run
    return self.run_and_check(session, prepped_request, extra_options)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 191, in run_and_check
    self.check_response(response)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/hooks/http.py", line 156, in check_response
    raise AirflowException(str(response.status_code) + ":" + response.reason)
airflow.exceptions.AirflowException: 404:Not Found

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/taskinstance.py", line 1452, in handle_failure
    callback(context)
  File "/home/ub/airflow/dags/slag_practice.py", line 16, in on_failure_callback
    dag=dag
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/baseoperator.py", line 89, in __call__
    obj: BaseOperator = type.__call__(cls, *args, **kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/utils/decorators.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/slack/operators/slack_webhook.py", line 91, in __init__
    super().__init__(endpoint=webhook_token, **kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/utils/decorators.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/providers/http/operators/http.py", line 88, in __init__
    super().__init__(**kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/utils/decorators.py", line 94, in wrapper
    result = func(*args, **kwargs)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/models/baseoperator.py", line 410, in __init__
    task_group.add(self)
  File "/home/ub/airflow/env/lib/python3.6/site-packages/airflow/utils/task_group.py", line 140, in add
    raise DuplicateTaskIdFound(f"Task id '{key}' has already been added to the DAG")
airflow.exceptions.DuplicateTaskIdFound: Task id 'slack_test' has already been added to the DAG
[2020-12-28 14:58:21,819] {local_task_job.py:118} INFO - Task exited with return code 1
